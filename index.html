<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sales Order Data Entry</title>
<style>
    /* ‰øùÊåÅÂéüÊúâÊ†∑Âºè‰∏çÂèò */
    * { box-sizing: border-box; margin:0; padding:0; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    body { background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; display:flex; justify-content:center; align-items:center; padding:20px; }
    .container { background:white; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.2); width:100%; max-width:800px; padding:30px; }
    h1 { color:#333; text-align:center; margin-bottom:30px; font-size:28px; font-weight:600; }
    .date-info { background:#f8f9fa; border-radius:8px; padding:15px; margin-bottom:25px; text-align:center; border-left:4px solid #667eea; }
    .current-month { font-size:18px; color:#667eea; font-weight:600; }
    .form-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; margin-bottom:25px; }
    .form-group { display:flex; flex-direction:column; }
    label { font-weight:500; color:#555; margin-bottom:6px; font-size:14px; }
    input, select { padding:12px; border:1px solid #ddd; border-radius:6px; font-size:14px; transition:border-color 0.3s; }
    input:focus, select:focus { outline:none; border-color:#667eea; box-shadow:0 0 0 2px rgba(102,126,234,0.1); }
    .full-width { grid-column:1 / -1; }
    .button-container { display:flex; justify-content:center; gap:15px; margin-top:30px; }
    button { padding:14px 30px; border:none; border-radius:6px; font-size:16px; font-weight:600; cursor:pointer; transition:all 0.3s; }
    .submit-btn { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; min-width:200px; }
    .submit-btn:hover { transform:translateY(-2px); box-shadow:0 5px 15px rgba(102,126,234,0.4); }
    .submit-btn:active { transform:translateY(0); }
    .reset-btn { background:#f8f9fa; color:#666; border:1px solid #ddd; }
    .reset-btn:hover { background:#e9ecef; }
    .status-message { margin-top:20px; padding:12px; border-radius:6px; text-align:center; display:none; }
    .success { background:#d4edda; color:#155724; border:1px solid #c3e6cb; }
    .error { background:#f8d7da; color:#721c24; border:1px solid #f5c6cb; }
    .loading { background:#fff3cd; color:#856404; border:1px solid #ffeaa7; }
    .info { background:#d1ecf1; color:#0c5460; border:1px solid #bee5eb; }
    @media (max-width:600px){ .form-grid{grid-template-columns:1fr;} .container{padding:20px;} .button-container{flex-direction:column;} }
</style>
</head>
<body>
<div class="container">
    <h1>üìã Sales Order Entry System</h1>

    <!-- Date Info -->
    <div class="date-info">
        <div class="current-month" id="currentMonth"></div>
        <div style="margin-top:8px; color:#666; font-size:14px;">Data will be saved to the corresponding Google Sheet for this month</div>
        <div style="margin-top:8px; color:#666; font-size:12px;" id="targetSheetInfo"></div>
    </div>

    <!-- Hidden iframe for form submission -->
    <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="iframeLoaded()"></iframe>

    <!-- Main Form -->
    <form id="salesForm" target="hidden_iframe" method="post">
        <div class="form-grid">
            <div class="form-group">
                <label for="salesOrder">Sales Order No. *</label>
                <input type="text" id="salesOrder" name="salesOrder" required placeholder="e.g., SO-2025-001">
            </div>
            <div class="form-group">
                <label for="customerName">Customer Name *</label>
                <input type="text" id="customerName" name="customerName" required placeholder="e.g., ABC Corporation">
            </div>
            <div class="form-group">
                <label for="itemNo">Item No. *</label>
                <input type="text" id="itemNo" name="itemNo" required placeholder="e.g., ITM-001">
            </div>
            <div class="form-group">
                <label for="itemName">Item Name *</label>
                <input type="text" id="itemName" name="itemName" required placeholder="e.g., Widget Pro">
            </div>
            <div class="form-group full-width">
                <label for="dimension">Dimension</label>
                <input type="text" id="dimension" name="dimension" placeholder="e.g., 100x200x50 mm">
            </div>
            <div class="form-group">
                <label for="quantity">Quantity *</label>
                <input type="number" id="quantity" name="quantity" required min="1" step="1" placeholder="e.g., 100">
            </div>
            <div class="form-group">
                <label for="unit">Unit of Measurement *</label>
                <select id="unit" name="unit" required>
                    <option value="">Select Unit</option>
                    <option value="PCS">PCS</option>
                    <option value="SET">SET</option>
                    <option value="KG">KG</option>
                    <option value="M">M</option>
                    <option value="M2">M¬≤</option>
                    <option value="M3">M¬≥</option>
                    <option value="EA">EA</option>
                    <option value="BOX">BOX</option>
                    <option value="PAIR">PAIR</option>
                    <option value="OTHER">OTHER</option>
                </select>
            </div>
        </div>

        <!-- Hidden fields for month/year/sheetId -->
        <input type="hidden" id="month" name="month">
        <input type="hidden" id="year" name="year">
        <input type="hidden" id="sheetId" name="sheetId">

        <div class="button-container">
            <button type="button" class="reset-btn" onclick="resetForm()">Reset Form</button>
            <button type="submit" class="submit-btn" onclick="prepareForm()">Submit to Google Sheet</button>
        </div>
        <div id="statusMessage" class="status-message"></div>
    </form>
</div>

<script>
const GAS_URL = 'https://script.google.com/macros/s/AKfycbzu6U2x8GvfhILHxOPT5n_E-nhTr37G-zVfSuXshIFA46sdD1BsO4bSW2vh8hpWIF7U/exec';

const SHEET_MAP = {
    '2025-12': '1qXNCBNvO3e8SUxHq8g84ditVSbNRvkw2g1M2C9bWw68',
    '2026-1': '1rO89kIwrjCMzIbIjny8O8nT8kp-WSm6GDZH8CPQZysg',
    '2026-2': '1H6koj_rbNziPupTsg0QrrWhtk6O-Lp7uZ-GQeQStVoE'
};

document.addEventListener('DOMContentLoaded', function() {
    updateDateInfo();
});

// Êõ¥Êñ∞Êó•Êúü‰ø°ÊÅØ
function updateDateInfo(){
    const now=new Date();
    const monthYear=now.toLocaleString('en-US',{month:'long',year:'numeric'});
    const month=now.getMonth()+1;
    const year=now.getFullYear();
    const key=`${year}-${month}`;
    const sheetId=SHEET_MAP[key]||SHEET_MAP['2025-12'];
    document.getElementById('currentMonth').textContent=`Current Month: ${monthYear}`;
    const shortSheetId=sheetId?`${sheetId.substring(0,10)}...`:'Not found';
    document.getElementById('targetSheetInfo').innerHTML=`Target Google Sheet: <code>${shortSheetId}</code>`;
}

// ÂáÜÂ§áË°®ÂçïÈöêËóèÂ≠óÊÆµÂπ∂ËÆæÁΩÆ action
function prepareForm(){
    const now=new Date();
    const month=now.getMonth()+1;
    const year=now.getFullYear();
    const key=`${year}-${month}`;
    const sheetId=SHEET_MAP[key]||SHEET_MAP['2025-12'];

    document.getElementById('month').value=month;
    document.getElementById('year').value=year;
    document.getElementById('sheetId').value=sheetId;

    document.getElementById('salesForm').action=GAS_URL;

    const statusDiv=document.getElementById('statusMessage');
    statusDiv.className='status-message loading';
    statusDiv.innerHTML='‚è≥ Submitting data to Google Sheet...';
    statusDiv.style.display='block';
}

// iframe load ÂõûË∞É
function iframeLoaded(){
    const statusDiv=document.getElementById('statusMessage');
    if(statusDiv.innerHTML.includes('Submitting')){
        statusDiv.className='status-message success';
        statusDiv.innerHTML='‚úÖ Data submitted successfully! Check your Google Sheet for the new tab.';
        setTimeout(()=>{
            resetForm();
            statusDiv.style.display='none';
        },5000);
    }
}

// ÈáçÁΩÆË°®Âçï
function resetForm(){
    document.getElementById('salesForm').reset();
    document.getElementById('statusMessage').style.display='none';
}
</script>
</body>
</html>
